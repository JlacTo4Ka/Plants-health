# Plants-health

## Цели проекта

### Цель машинного обучения (ML):
- Разработать модель классификации, которая определяет, здорова ли культура или какой тип заболевания присутствует.
- Достичь высокой точности (более 95%) на тестовом наборе данных.
- Обеспечить быструю и качественную обработку запросов пользователей.

### Бизнес-цель:
- Снизить расходы на диагностику заболеваний.
- Увеличить урожайность за счет своевременного выявления проблем с растениями.
- Автоматизировать процесс мониторинга состояния растений.

### Основная цель:
- Монетизация через модель подписки и платные запросы, позволяя пользователям получать доступ к высококачественным результатам анализа заболеваний растений.

---

## Описание проекта
Мы разработали систему для автоматического выявления заболеваний растений по изображениям листьев. Для этого была использована модель, основанная на модифицированной архитектуре ResNet9 с остаточными блоками, которые повышают производительность и эффективность.

Решение помогает фермерам и агрономам оперативно определять болезни и принимать меры для их устранения. Помимо анализа изображения, пользователи получают полезную текстовую информацию через ответ от YandexGPT.

---

## Что такое классификация?
Классификация — это задача машинного обучения, при которой модель предсказывает категорию (класс) для входных данных. Цель классификации в этом проекте:
1. Определение здоровья растения (здоровое/больное).
2. Распознавание конкретного заболевания на основе изображений листьев.

Модель обучается на наборе данных изображений, где каждая картинка имеет метку (название заболевания или "здоровое"). После обучения модель способна анализировать новые изображения и предсказывать, к какому классу они принадлежат.

---

## Функция потерь
Для обучения модели использовалась **Cross-Entropy Loss (кросс-энтропия)** — основная функция потерь для многоклассовой классификации. 

### Формула:
![](info_img/loss.png)

Где:
- \(L\) — значение функции потерь.
- \(N\) — количество примеров в одном батче.
- \(p_{y_i}\) — предсказанная моделью вероятность для истинного класса.
- \(y_i\) — истинный класс для \(i\)-го примера.

---

## Dataset
Мы использовали **New Plant Diseases Dataset (Augmented)** для обучения модели. 

### Характеристики датасета:
- **Количество классов:** 38 (комбинации названия растения и состояния, например, "Apple___Scab").
- **Растения:** 14 видов.
- **Заболевания:** 26 видов.
- **Общее количество изображений:**
  - ~87,000 для обучения.
  - ~21,000 для валидации.
- **Количество изображений на класс:** В среднем ~2300.
- **Распределение:** Почти равномерное, что делает датасет сбалансированным.

---

## Архитектура ResNet9
Для решения задачи классификации изображений листьев растений была выбрана архитектура **ResNet9**, которая сочетает остаточные связи и свёрточные блоки.

### Структура модели:
1. **Первые свёрточные блоки (ConvBlock1 и ConvBlock2):**
   - Извлечение низкоуровневых признаков (края, текстуры, цветовые паттерны).
   - Используют свёрточные операции, нормализацию (BatchNorm2d) и активацию ReLU.

2. **Средние слои (ConvBlock3, ConvBlock4 и Res1):**
   - Кодируют более сложные текстуры и формы, характерные для конкретных заболеваний.
   - Остаточные блоки позволяют сохранять и комбинировать признаки из предыдущих слоев.

3. **Последние слои (Res2 и классификатор):**
   - Обрабатывают высокоуровневые признаки (структура, контекст изображения).
   - Классификатор включает MaxPooling, Flatten и полносвязный слой для классификации на 38 классов.

### Преимущества ResNet9:
- Эффективное обучение за счёт остаточных связей.
- Высокая производительность при сравнительно небольшой сложности.
- Быстрое обучение по сравнению с более глубокими сетями (ResNet50, ResNet101).

---

## Результаты
- **Точность:** 99% на валидационном наборе данных.
- **Функция потерь:** Очень низкое значение:
  - Epoch [0]: `train_loss: 0.7574`, `val_loss: 0.5515`, `val_acc: 83.64%`.
  - Epoch [1]: `train_loss: 0.1251`, `val_loss: 0.0274`, `val_acc: 99.16%`.
- **Время обучения:** ~33 минуты.

---